# üìä –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π MTF —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ (1h + 15m)

## üéØ –û–±–∑–æ—Ä

–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è MTF (Multi-Timeframe) —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –¥–≤—É—Ö —Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤:
- **1h –º–æ–¥–µ–ª—å**: –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –æ–±—â–µ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–µ–Ω–¥–∞ (—Ñ–∏–ª—å—Ç—Ä)
- **15m –º–æ–¥–µ–ª—å**: –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–æ—á–Ω—É—é —Ç–æ—á–∫—É –≤—Ö–æ–¥–∞

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

1. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ª–æ–∂–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤**: 1h –º–æ–¥–µ–ª—å –æ—Ç—Å–µ–∫–∞–µ—Ç —à—É–º –∏ –ª–æ–∂–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã
2. **–¢–æ—á–Ω—ã–µ –≤—Ö–æ–¥—ã**: 15m –º–æ–¥–µ–ª—å –¥–∞–µ—Ç –ª—É—á—à–∏–π —Ç–∞–π–º–∏–Ω–≥ –¥–ª—è –≤—Ö–æ–¥–∞
3. **–ü–æ–≤—ã—à–µ–Ω–∏–µ Win Rate**: –í—Ö–æ–¥ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π –æ–±–µ–∏—Ö –º–æ–¥–µ–ª–µ–π
4. **–ì–∏–±–∫–æ—Å—Ç—å**: –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É —Ä–µ–∂–∏–º–∞–º–∏ "strict" –∏ "weighted"

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å –º–æ–¥–µ–ª–∏ –¥–ª—è –æ–±–æ–∏—Ö —Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤:

```bash
# –û–±—É—á–∞–µ–º 1h –º–æ–¥–µ–ª–∏
python retrain_ml_optimized.py --interval 60m --no-mtf --symbol BTCUSDT

# –û–±—É—á–∞–µ–º 15m –º–æ–¥–µ–ª–∏
python retrain_ml_optimized.py --interval 15m --no-mtf --symbol BTCUSDT
```

### 2. –í–∫–ª—é—á–µ–Ω–∏–µ MTF —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (`bot/config.py` –∏–ª–∏ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è):

```python
# –í config.py
ml_strategy = StrategyParams(
    use_mtf_strategy=True,  # –í–∫–ª—é—á–∏—Ç—å MTF —Å—Ç—Ä–∞—Ç–µ–≥–∏—é
    mtf_confidence_threshold_1h=0.50,  # –ü–æ—Ä–æ–≥ –¥–ª—è 1h (—Ñ–∏–ª—å—Ç—Ä)
    mtf_confidence_threshold_15m=0.35,  # –ü–æ—Ä–æ–≥ –¥–ª—è 15m (–≤—Ö–æ–¥)
    mtf_alignment_mode="strict",  # "strict" –∏–ª–∏ "weighted"
    mtf_require_alignment=True,  # –¢—Ä–µ–±–æ–≤–∞—Ç—å —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π
)
```

–ò–ª–∏ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```bash
export ML_MTF_STRATEGY_ENABLED=true
export ML_MTF_CONFIDENCE_1H=0.50
export ML_MTF_CONFIDENCE_15M=0.35
export ML_MTF_ALIGNMENT_MODE=strict
```

### 3. –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞

–ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–π–¥–µ—Ç –æ–±–µ –º–æ–¥–µ–ª–∏ (1h –∏ 15m) –∏ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å MTF —Å—Ç—Ä–∞—Ç–µ–≥–∏—é:

```bash
python run_bot.py
```

## üìä –ë—ç–∫—Ç–µ—Å—Ç

### –ë–∞–∑–æ–≤—ã–π –±—ç–∫—Ç–µ—Å—Ç

```bash
# –ë—ç–∫—Ç–µ—Å—Ç –¥–ª—è BTCUSDT –Ω–∞ 30 –¥–Ω–µ–π
python backtest_mtf_strategy.py --symbol BTCUSDT --days 30
```

### –° –∫–∞—Å—Ç–æ–º–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

```bash
# –ë—ç–∫—Ç–µ—Å—Ç —Å –ø–æ–≤—ã—à–µ–Ω–Ω—ã–º–∏ –ø–æ—Ä–æ–≥–∞–º–∏ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏
python backtest_mtf_strategy.py \
    --symbol ETHUSDT \
    --days 60 \
    --conf-1h 0.60 \
    --conf-15m 0.40 \
    --alignment-mode strict
```

### –í–∑–≤–µ—à–µ–Ω–Ω–æ–µ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ

```bash
# –ë—ç–∫—Ç–µ—Å—Ç –≤ —Ä–µ–∂–∏–º–µ –≤–∑–≤–µ—à–µ–Ω–Ω–æ–≥–æ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è
python backtest_mtf_strategy.py \
    --symbol SOLUSDT \
    --days 30 \
    --alignment-mode weighted \
    --no-require-alignment
```

### –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

```bash
# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏
python backtest_mtf_strategy.py \
    --symbol BTCUSDT \
    --days 30 \
    --save \
    --plot
```

## ‚öôÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### `use_mtf_strategy` (bool)
–í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å MTF —Å—Ç—Ä–∞—Ç–µ–≥–∏—é. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `False`

### `mtf_confidence_threshold_1h` (float)
–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å 1h –º–æ–¥–µ–ª–∏ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `0.50`

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- –ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–π: `0.60-0.70` (–º–µ–Ω—å—à–µ —Å–∏–≥–Ω–∞–ª–æ–≤, –≤—ã—à–µ –∫–∞—á–µ—Å—Ç–≤–æ)
- –£–º–µ—Ä–µ–Ω–Ω—ã–π: `0.50-0.60` (–±–∞–ª–∞–Ω—Å)
- –ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π: `0.40-0.50` (–±–æ–ª—å—à–µ —Å–∏–≥–Ω–∞–ª–æ–≤)

### `mtf_confidence_threshold_15m` (float)
–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å 15m –º–æ–¥–µ–ª–∏ –¥–ª—è –≤—Ö–æ–¥–∞. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `0.35`

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- –ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–π: `0.45-0.55`
- –£–º–µ—Ä–µ–Ω–Ω—ã–π: `0.35-0.45`
- –ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π: `0.25-0.35`

### `mtf_alignment_mode` (str)
–†–µ–∂–∏–º –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
- `"strict"`: –°—Ç—Ä–æ–≥–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- `"weighted"`: –í–∑–≤–µ—à–µ–Ω–Ω–æ–µ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ

### `mtf_require_alignment` (bool)
–¢—Ä–µ–±–æ–≤–∞—Ç—å —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π –æ–±–µ–∏—Ö –º–æ–¥–µ–ª–µ–π. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `True`

**–õ–æ–≥–∏–∫–∞:**
- `True` + `strict`: –í—Ö–æ–¥ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –æ–±–µ –º–æ–¥–µ–ª–∏ –¥–∞—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
- `False` + `weighted`: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–∑–≤–µ—à–µ–Ω–Ω–æ–µ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ –¥–∞–∂–µ –ø—Ä–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–µ

## üîç –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### –†–µ–∂–∏–º "strict" (—Å—Ç—Ä–æ–≥–∏–π)

1. 1h –º–æ–¥–µ–ª—å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–µ–Ω–¥–∞
2. –ï—Å–ª–∏ 1h –¥–∞–µ—Ç —Å–∏–≥–Ω–∞–ª (LONG/SHORT), –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è 15m –º–æ–¥–µ–ª—å
3. –ï—Å–ª–∏ 15m –¥–∞–µ—Ç —Ç–æ—Ç –∂–µ —Å–∏–≥–Ω–∞–ª - –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø–æ–∑–∏—Ü–∏—è
4. –ï—Å–ª–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç - —Å–∏–≥–Ω–∞–ª –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è

**–ü—Ä–∏–º–µ—Ä:**
```
1h: LONG (confidence: 0.65) ‚úÖ
15m: LONG (confidence: 0.42) ‚úÖ
‚Üí –í—Ö–æ–¥ –≤ LONG —Å –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å—é 0.51

1h: LONG (confidence: 0.60) ‚úÖ
15m: SHORT (confidence: 0.45) ‚ùå
‚Üí –°–∏–≥–Ω–∞–ª –æ—Ç–∫–ª–æ–Ω–µ–Ω (–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç)
```

### –†–µ–∂–∏–º "weighted" (–≤–∑–≤–µ—à–µ–Ω–Ω—ã–π)

1. –û–±–µ –º–æ–¥–µ–ª–∏ –¥–∞—é—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
2. –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å = 0.4 √ó conf_1h + 0.6 √ó conf_15m
3. –ü—Ä–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–æ–ª–µ–µ —É–≤–µ—Ä–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å (—Å –ø–æ–Ω–∏–∂–µ–Ω–Ω–æ–π —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å—é)

**–ü—Ä–∏–º–µ—Ä:**
```
1h: LONG (0.70), 15m: LONG (0.50)
‚Üí –í—Ö–æ–¥ –≤ LONG —Å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å—é 0.58

1h: LONG (0.60), 15m: SHORT (0.55)
‚Üí –ö–æ–Ω—Ñ–ª–∏–∫—Ç, 15m –±–æ–ª–µ–µ —É–≤–µ—Ä–µ–Ω–∞ ‚Üí –í—Ö–æ–¥ –≤ SHORT —Å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å—é 0.33
```

## üìà –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º–∏

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ MTF —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏:

1. **–í—ã—à–µ Win Rate**: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ª–æ–∂–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ —á–µ—Ä–µ–∑ 1h –º–æ–¥–µ–ª—å
2. **–ú–µ–Ω—å—à–µ –ª–æ–∂–Ω—ã—Ö –≤—Ö–æ–¥–æ–≤**: –í—Ö–æ–¥ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π
3. **–õ—É—á—à–∏–π —Ç–∞–π–º–∏–Ω–≥**: 15m –º–æ–¥–µ–ª—å –¥–∞–µ—Ç —Ç–æ—á–Ω—É—é —Ç–æ—á–∫—É –≤—Ö–æ–¥–∞
4. **–ú–µ–Ω—å—à–µ —Å–¥–µ–ª–æ–∫**: –ö–∞—á–µ—Å—Ç–≤–æ –≤–∞–∂–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞

### –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:

1. **–ú–µ–Ω—å—à–µ —Å–∏–≥–Ω–∞–ª–æ–≤**: –°—Ç—Ä–æ–≥–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –º–æ–≥—É—Ç –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
2. **–¢—Ä–µ–±—É–µ—Ç –æ–±–µ –º–æ–¥–µ–ª–∏**: –ù—É–∂–Ω—ã –æ–±—É—á–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –æ–±–æ–∏—Ö —Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤
3. **–°–ª–æ–∂–Ω–µ–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞**: –ë–æ–ª—å—à–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

### 1. –ë–∞–∑–æ–≤—ã–π —Ç–µ—Å—Ç

```bash
python backtest_mtf_strategy.py --symbol BTCUSDT --days 30
```

### 2. –¢–µ—Å—Ç —Ä–∞–∑–Ω—ã—Ö –ø–æ—Ä–æ–≥–æ–≤

```bash
# –ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–π
python backtest_mtf_strategy.py --symbol BTCUSDT --days 30 --conf-1h 0.60 --conf-15m 0.45

# –£–º–µ—Ä–µ–Ω–Ω—ã–π
python backtest_mtf_strategy.py --symbol BTCUSDT --days 30 --conf-1h 0.50 --conf-15m 0.35

# –ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π
python backtest_mtf_strategy.py --symbol BTCUSDT --days 30 --conf-1h 0.40 --conf-15m 0.25
```

### 3. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∂–∏–º–æ–≤

```bash
# –°—Ç—Ä–æ–≥–∏–π —Ä–µ–∂–∏–º
python backtest_mtf_strategy.py --symbol BTCUSDT --days 30 --alignment-mode strict

# –í–∑–≤–µ—à–µ–Ω–Ω—ã–π —Ä–µ–∂–∏–º
python backtest_mtf_strategy.py --symbol BTCUSDT --days 30 --alignment-mode weighted
```

### 4. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º–∏

```bash
# –¢–µ—Å—Ç —Ç–æ–ª—å–∫–æ 15m
python backtest_ml_strategy.py --symbol BTCUSDT --days 30 --model ml_models/quad_ensemble_BTCUSDT_15_15m.pkl

# –¢–µ—Å—Ç —Ç–æ–ª—å–∫–æ 1h
python backtest_ml_strategy.py --symbol BTCUSDT --days 30 --model ml_models/ensemble_BTCUSDT_60_1h.pkl

# –¢–µ—Å—Ç MTF
python backtest_mtf_strategy.py --symbol BTCUSDT --days 30
```

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –û—à–∏–±–∫–∞: "1h –º–æ–¥–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å –æ–±—É—á–µ–Ω–Ω—ã–µ 1h –º–æ–¥–µ–ª–∏:
   ```bash
   ls ml_models/*_BTCUSDT_60_*.pkl
   ```
2. –ï—Å–ª–∏ –Ω–µ—Ç - –æ–±—É—á–∏—Ç–µ:
   ```bash
   python retrain_ml_optimized.py --interval 60m --symbol BTCUSDT
   ```

### –û—à–∏–±–∫–∞: "15m –º–æ–¥–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å –æ–±—É—á–µ–Ω–Ω—ã–µ 15m –º–æ–¥–µ–ª–∏:
   ```bash
   ls ml_models/*_BTCUSDT_15_*.pkl
   ```
2. –ï—Å–ª–∏ –Ω–µ—Ç - –æ–±—É—á–∏—Ç–µ:
   ```bash
   python retrain_ml_optimized.py --interval 15m --symbol BTCUSDT
   ```

### –ú–∞–ª–æ —Å–∏–≥–Ω–∞–ª–æ–≤

**–ü—Ä–∏—á–∏–Ω—ã:**
- –°–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫–∏–µ –ø–æ—Ä–æ–≥–∏ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏
- –°—Ç—Ä–æ–≥–∏–π —Ä–µ–∂–∏–º –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è
- –ú–æ–¥–µ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç –ø–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é

**–†–µ—à–µ–Ω–∏—è:**
1. –°–Ω–∏–∑—å—Ç–µ –ø–æ—Ä–æ–≥–∏:
   ```python
   mtf_confidence_threshold_1h=0.40
   mtf_confidence_threshold_15m=0.30
   ```
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–∑–≤–µ—à–µ–Ω–Ω—ã–π —Ä–µ–∂–∏–º:
   ```python
   mtf_alignment_mode="weighted"
   mtf_require_alignment=False
   ```

### –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —Å–∏–≥–Ω–∞–ª–æ–≤

**–ü—Ä–∏—á–∏–Ω—ã:**
- –°–ª–∏—à–∫–æ–º –Ω–∏–∑–∫–∏–µ –ø–æ—Ä–æ–≥–∏
- –ú–æ–¥–µ–ª–∏ –¥–∞—é—Ç –º–Ω–æ–≥–æ —Å–∏–≥–Ω–∞–ª–æ–≤

**–†–µ—à–µ–Ω–∏—è:**
1. –ü–æ–≤—ã—Å—å—Ç–µ –ø–æ—Ä–æ–≥–∏:
   ```python
   mtf_confidence_threshold_1h=0.60
   mtf_confidence_threshold_15m=0.45
   ```
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç—Ä–æ–≥–∏–π —Ä–µ–∂–∏–º:
   ```python
   mtf_alignment_mode="strict"
   mtf_require_alignment=True
   ```

## üìù –ü—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π

### –ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω–∞—è (–≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ, –º–∞–ª–æ —Å–¥–µ–ª–æ–∫)

```python
ml_strategy = StrategyParams(
    use_mtf_strategy=True,
    mtf_confidence_threshold_1h=0.65,
    mtf_confidence_threshold_15m=0.50,
    mtf_alignment_mode="strict",
    mtf_require_alignment=True,
)
```

### –£–º–µ—Ä–µ–Ω–Ω–∞—è (–±–∞–ª–∞–Ω—Å –∫–∞—á–µ—Å—Ç–≤–∞ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞)

```python
ml_strategy = StrategyParams(
    use_mtf_strategy=True,
    mtf_confidence_threshold_1h=0.50,
    mtf_confidence_threshold_15m=0.35,
    mtf_alignment_mode="strict",
    mtf_require_alignment=True,
)
```

### –ê–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è (–±–æ–ª—å—à–µ —Å–¥–µ–ª–æ–∫, –Ω–∏–∂–µ –∫–∞—á–µ—Å—Ç–≤–æ)

```python
ml_strategy = StrategyParams(
    use_mtf_strategy=True,
    mtf_confidence_threshold_1h=0.40,
    mtf_confidence_threshold_15m=0.30,
    mtf_alignment_mode="weighted",
    mtf_require_alignment=False,
)
```

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ù–∞—á–Ω–∏—Ç–µ —Å —É–º–µ—Ä–µ–Ω–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤** –∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
2. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Å–∏–º–≤–æ–ª–∞—Ö** - –∫–∞–∂–¥—ã–π –º–æ–∂–µ—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
3. **–°—Ä–∞–≤–Ω–∏–≤–∞–π—Ç–µ —Å –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º–∏** –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è —É–ª—É—á—à–µ–Ω–∏–π
4. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ Win Rate –∏ Profit Factor** - –≥–ª–∞–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞
5. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç—Ä–æ–≥–∏–π —Ä–µ–∂–∏–º** –¥–ª—è –Ω–∞—á–∞–ª–∞, –∑–∞—Ç–µ–º —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å weighted

## üöÄ –í–Ω–µ–¥—Ä–µ–Ω–∏–µ –≤ –ø—Ä–æ–¥–∞–∫—à–Ω

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –ª—É—á—à–∏—Ö –º–æ–¥–µ–ª–µ–π

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ—Ç –ª—É—á—à–∏–µ –º–æ–¥–µ–ª–∏ –¥–ª—è MTF —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ (–≤ –ø–æ—Ä—è–¥–∫–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞):

1. **best_strategies_*.json** (–≤—ã—Å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç) - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
2. **comparison_15m_vs_1h.csv** - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ª—É—á—à–∏—Ö 15m –∏ 1h –º–æ–¥–µ–ª–µ–π
3. **ml_models_comparison_*.csv** - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π
4. **Fallback** - –ü–µ—Ä–≤—ã–µ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ (—Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ–º)

### –ü—Ä–æ—Ü–µ—Å—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

–î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–±–æ—Ä–∞ –ª—É—á—à–∏—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏—Å—Ç–µ–º—É –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:

```bash
# –ü–æ–ª–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (–æ–±—É—á–µ–Ω–∏–µ + —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ + MTF —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
python auto_strategy_optimizer.py

# –ë—ã—Å—Ç—Ä–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (—Ç–æ–ª—å–∫–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏ MTF —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
python optimize_strategies.py --quick
```

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –û–±—É—á–∞–µ—Ç –º–æ–¥–µ–ª–∏ –¥–ª—è –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
- –°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –º–æ–¥–µ–ª–∏ –∏ –Ω–∞—Ö–æ–¥–∏—Ç –ª—É—á—à–∏–µ
- –¢–µ—Å—Ç–∏—Ä—É–µ—Ç –≤—Å–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ MTF —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
- –í—ã–±–∏—Ä–∞–µ—Ç –ª—É—á—à–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–µ—Ç—Ä–∏–∫
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ `best_strategies_*.json`

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞

–î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é:

```bash
# –ó–∞–ø—É—Å–∫ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ (–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ –≤ 3:00)
python schedule_strategy_optimizer.py
```

–ò–ª–∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ cron/Task Scheduler (—Å–º. `AUTO_STRATEGY_OPTIMIZATION.md`).

### –í–∫–ª—é—á–µ–Ω–∏–µ MTF —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤ –±–æ—Ç–µ

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –º–æ–¥–µ–ª–∏ –æ–±—É—á–µ–Ω—ã –∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
2. –í–∫–ª—é—á–∏—Ç–µ MTF —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
   ```python
   use_mtf_strategy = True
   ```
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞ - –æ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∑–∏—Ç –ª—É—á—à–∏–µ –º–æ–¥–µ–ª–∏ –∏–∑ `best_strategies_*.json`

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–ë–æ—Ç –ª–æ–≥–∏—Ä—É–µ—Ç:
- –ò—Å—Ç–æ—á–Ω–∏–∫ –≤—ã–±–æ—Ä–∞ –º–æ–¥–µ–ª–µ–π (best_strategies.json, comparison_csv, fallback)
- –ò–º–µ–Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π
- –û–∂–∏–¥–∞–µ–º—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –∏–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏)

–ü—Ä–∏–º–µ—Ä –ª–æ–≥–∞:
```
[BTCUSDT] üîÑ Loading MTF strategy:
  Source: best_strategies_json
  1h model: quad_ensemble_BTCUSDT_60_1h.pkl
  15m model: quad_ensemble_BTCUSDT_15_15m.pkl
  Expected metrics: PnL=65.20%, WR=58.5%, PF=2.10
```

–ü–æ–¥—Ä–æ–±–Ω–µ–µ —Å–º. `AUTO_STRATEGY_OPTIMIZATION.md`.

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [COMPARISON_15M_VS_1H_SUMMARY.md](COMPARISON_15M_VS_1H_SUMMARY.md) - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ 15m –∏ 1h –º–æ–¥–µ–ª–µ–π
- [backtest_ml_strategy.py](backtest_ml_strategy.py) - –ë—ç–∫—Ç–µ—Å—Ç –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
- [retrain_ml_optimized.py](retrain_ml_optimized.py) - –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
- [AUTO_STRATEGY_OPTIMIZATION.md](AUTO_STRATEGY_OPTIMIZATION.md) - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- [auto_strategy_optimizer.py](auto_strategy_optimizer.py) - –£—Ç–∏–ª–∏—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- [optimize_strategies.py](optimize_strategies.py) - –û–±–µ—Ä—Ç–∫–∞ –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
